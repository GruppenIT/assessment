(venv) root@vlxweb12:/var/www/assessment# sudo supervisorctl tail -f assessment stderr
==> Press Ctrl-C to exit <==
emaining-tokens': '799519', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '36ms', 'x-request-id': 'req_fd724e58978f420bbdeb109c2e2ff7bb', 'x-openai-proxy-wasm': 'v0.1', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '98e0687a1e42a460-GRU', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
DEBUG:openai._base_client:request_id: req_fd724e58978f420bbdeb109c2e2ff7bb
INFO:root:Recomendação gerada para domínio Recuperar
INFO:root:Recomendação atribuída ao domínio Identificar
INFO:root:Recomendação atribuída ao domínio Proteger
INFO:root:Recomendação atribuída ao domínio Detectar
INFO:root:Recomendação atribuída ao domínio Reagir
INFO:root:Recomendação atribuída ao domínio Recuperar
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
INFO:root:Dados do respondente salvos para assessment público 20
INFO:root:Iniciando criação de lead para assessment público 20
ERROR:root:✗ ERRO ao criar lead automático para assessment 20: 'NoneType' object has no attribute 'nome'
Traceback (most recent call last):
  File "/var/www/assessment/routes/publico.py", line 226, in dados_respondente
    lead = Lead.criar_de_assessment_publico(assessment_publico)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/www/assessment/models/lead.py", line 70, in criar_de_assessment_publico
    tipo_assessment_nome=assessment_publico.tipo_assessment.nome,
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'nome'
INFO:root:Gerando recomendações IA para assessment público 20
DEBUG:root:OpenAI API key descriptografada com sucesso. Tamanho: 164
DEBUG:root:OpenAI API key format check: starts_with_sk=True
DEBUG:root:OpenAI config: api_key_configured=True, assistant_name=asst_HMYchoc6I6hHowb8UUqssl4l
INFO:root:Cliente OpenAI inicializado com assistant: asst_HMYchoc6I6hHowb8UUqssl4l
DEBUG:root:API key válida: sk-proj-gS...JhsPAA
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-d98a420b-644b-4bd6-a455-1c8282843a4b', 'json_data': {'messages': [{'role': 'system', 'content': 'Você é asst_HMYchoc6I6hHowb8UUqssl4l. Você gera recomendações práticas e diretas para melhorias em assessments de maturidade organizacional.'}, {'role': 'user', 'content': '\n            Como consultor especializado em assessments de maturidade organizacional, analise as respostas do domínio "Identificar" e forneça recomendações práticas de melhoria.\n\n            **DADOS DO DOMÍNIO:**\n            - Nome: Identificar\n            - Descrição: Garantir que os backups sejam armazenados com criptografia, imutabilidade e controles de acesso rígidos (como MFA), seguindo a regra 3-2-1-1-0, para resistir a ataques ou corrupção.\n            - Pontuação obtida: 100.0%\n            \n            **RESPOSTAS DO DOMÍNIO:**\n            [\n  {\n    "pergunta": "Existem Notificações por e-mail configuradas?",\n    "resposta": "Sim",\n    "valor": 5\n  },\n  {\n    "pergunta": "Servidores de Backup enviam traps SNMP ou e-mail para soluções de correlacionamento?",\n    "resposta": "Sim",\n    "valor": 5\n  }\n]\n            \n            **INSTRUÇÕES PARA RECOMENDAÇÃO:**\n            1. Analise as respostas considerando:\n               - Respostas "Não" (valor 0) indicam ausência total da prática\n               - Respostas "Parcial" (valor 3) indicam implementação parcial\n               - Respostas "Sim" (valor 5) indicam implementação completa\n            \n            2. Identifique os principais gaps (respostas "Não" e "Parcial")\n            \n            3. Forneça 2-3 recomendações práticas e objetivas focadas em:\n               - Priorizar ações para as áreas com resposta "Não"\n               - Melhorar áreas com resposta "Parcial"\n               - Fortalecer processos já implementados\n            \n            4. Use linguagem direta e profissional\n            \n            5. Estruture a resposta em um único parágrafo de 4-6 linhas\n            \n            **FORMATO DE SAÍDA:**\n            Retorne apenas o texto da recomendação, sem título ou formatação markdown.\n            '}], 'model': 'gpt-4o', 'max_tokens': 500, 'temperature': 0.7}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.connection:connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=60 socket_options=None
DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7cfc0fd6a720>
DEBUG:httpcore.connection:start_tls.started ssl_context=<ssl.SSLContext object at 0x7cfc143e6550> server_hostname='api.openai.com' timeout=60
DEBUG:httpcore.connection:start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7cfc0fd6a600>
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 13 Oct 2025 17:17:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-sitqrklbz9btdmisad8q7tj6'), (b'openai-processing-ms', b'3196'), (b'openai-project', b'proj_9512SLV5rqqwN8ADlX3u9SV4'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'3523'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'800000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'799497'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'37ms'), (b'x-request-id', b'req_621c8f0eecd040f48ec9bbfd37c42688'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=2FOCVgPA.wY3NAAkMey4E_XPKKWHdboB9bFmsoE1za8-1760375871-1.0.1.1-CI3jHHgPX8nBvgKgEytVajqum4VVr_aoktO1c9qGjqPqh1cKVs36u9bsnOjJ38GFw.nOog85p7su.aghG8aXpIAyHsb_xuPeEZlymS8gN.k; path=/; expires=Mon, 13-Oct-25 17:47:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=QHw4R9m0HX5h.AzG3oszIdQRksXexyfg5gfFuV89fpM-1760375871581-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'98e07e126d50e020-GRU'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 13 Oct 2025 17:17:51 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-sitqrklbz9btdmisad8q7tj6'), ('openai-processing-ms', '3196'), ('openai-project', 'proj_9512SLV5rqqwN8ADlX3u9SV4'), ('openai-version', '2020-10-01'), ('x-envoy-upstream-service-time', '3523'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '800000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '799497'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '37ms'), ('x-request-id', 'req_621c8f0eecd040f48ec9bbfd37c42688'), ('x-openai-proxy-wasm', 'v0.1'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=2FOCVgPA.wY3NAAkMey4E_XPKKWHdboB9bFmsoE1za8-1760375871-1.0.1.1-CI3jHHgPX8nBvgKgEytVajqum4VVr_aoktO1c9qGjqPqh1cKVs36u9bsnOjJ38GFw.nOog85p7su.aghG8aXpIAyHsb_xuPeEZlymS8gN.k; path=/; expires=Mon, 13-Oct-25 17:47:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=QHw4R9m0HX5h.AzG3oszIdQRksXexyfg5gfFuV89fpM-1760375871581-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '98e07e126d50e020-GRU'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
DEBUG:openai._base_client:request_id: req_621c8f0eecd040f48ec9bbfd37c42688
INFO:root:Recomendação gerada para domínio Identificar
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-9800941b-047c-4550-958b-67e21a1b57f3', 'json_data': {'messages': [{'role': 'system', 'content': 'Você é asst_HMYchoc6I6hHowb8UUqssl4l. Você gera recomendações práticas e diretas para melhorias em assessments de maturidade organizacional.'}, {'role': 'user', 'content': '\n            Como consultor especializado em assessments de maturidade organizacional, analise as respostas do domínio "Proteger" e forneça recomendações práticas de melhoria.\n\n            **DADOS DO DOMÍNIO:**\n            - Nome: Proteger\n            - Descrição: Garantir que os backups sejam armazenados com criptografia, imutabilidade e controles de acesso rígidos (como MFA), seguindo a regra 3-2-1-1-0, para resistir a ataques ou corrupção.\n            - Pontuação obtida: 100.0%\n            \n            **RESPOSTAS DO DOMÍNIO:**\n            [\n  {\n    "pergunta": "Cópias ou offload de backups para object storage são criptografados?",\n    "resposta": "Sim",\n    "valor": 5\n  },\n  {\n    "pergunta": "Existe repositórios SMB/NFS configurados em algum ambiente? Se sim quais as versões dos protocolos?",\n    "resposta": "Sim",\n    "valor": 5\n  }\n]\n            \n            **INSTRUÇÕES PARA RECOMENDAÇÃO:**\n            1. Analise as respostas considerando:\n               - Respostas "Não" (valor 0) indicam ausência total da prática\n               - Respostas "Parcial" (valor 3) indicam implementação parcial\n               - Respostas "Sim" (valor 5) indicam implementação completa\n            \n            2. Identifique os principais gaps (respostas "Não" e "Parcial")\n            \n            3. Forneça 2-3 recomendações práticas e objetivas focadas em:\n               - Priorizar ações para as áreas com resposta "Não"\n               - Melhorar áreas com resposta "Parcial"\n               - Fortalecer processos já implementados\n            \n            4. Use linguagem direta e profissional\n            \n            5. Estruture a resposta em um único parágrafo de 4-6 linhas\n            \n            **FORMATO DE SAÍDA:**\n            Retorne apenas o texto da recomendação, sem título ou formatação markdown.\n            '}], 'model': 'gpt-4o', 'max_tokens': 500, 'temperature': 0.7}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 13 Oct 2025 17:17:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-sitqrklbz9btdmisad8q7tj6'), (b'openai-processing-ms', b'2324'), (b'openai-project', b'proj_9512SLV5rqqwN8ADlX3u9SV4'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'3851'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'800000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'799489'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'38ms'), (b'x-request-id', b'req_beb2a5a5c33047649d771b1997d4093f'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'98e07e2d9bc8e020-GRU'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 13 Oct 2025 17:17:57 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-sitqrklbz9btdmisad8q7tj6', 'openai-processing-ms': '2324', 'openai-project': 'proj_9512SLV5rqqwN8ADlX3u9SV4', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '3851', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '799489', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '38ms', 'x-request-id': 'req_beb2a5a5c33047649d771b1997d4093f', 'x-openai-proxy-wasm': 'v0.1', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '98e07e2d9bc8e020-GRU', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
DEBUG:openai._base_client:request_id: req_beb2a5a5c33047649d771b1997d4093f
INFO:root:Recomendação gerada para domínio Proteger
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-a824fed8-7b94-4da4-ac95-ed7225f1150d', 'json_data': {'messages': [{'role': 'system', 'content': 'Você é asst_HMYchoc6I6hHowb8UUqssl4l. Você gera recomendações práticas e diretas para melhorias em assessments de maturidade organizacional.'}, {'role': 'user', 'content': '\n            Como consultor especializado em assessments de maturidade organizacional, analise as respostas do domínio "Detectar" e forneça recomendações práticas de melhoria.\n\n            **DADOS DO DOMÍNIO:**\n            - Nome: Detectar\n            - Descrição: Implementar monitoramento ativo (SIEM, EDR) e processos automatizados para identificar falhas, atividades suspeitas ou malware em backups, antes que comprometam a recuperação.\n            - Pontuação obtida: 100.0%\n            \n            **RESPOSTAS DO DOMÍNIO:**\n            [\n  {\n    "pergunta": "Existe algum processo de detecção de malware durante o backup (inline detection)?",\n    "resposta": "Sim",\n    "valor": 5\n  }\n]\n            \n            **INSTRUÇÕES PARA RECOMENDAÇÃO:**\n            1. Analise as respostas considerando:\n               - Respostas "Não" (valor 0) indicam ausência total da prática\n               - Respostas "Parcial" (valor 3) indicam implementação parcial\n               - Respostas "Sim" (valor 5) indicam implementação completa\n            \n            2. Identifique os principais gaps (respostas "Não" e "Parcial")\n            \n            3. Forneça 2-3 recomendações práticas e objetivas focadas em:\n               - Priorizar ações para as áreas com resposta "Não"\n               - Melhorar áreas com resposta "Parcial"\n               - Fortalecer processos já implementados\n            \n            4. Use linguagem direta e profissional\n            \n            5. Estruture a resposta em um único parágrafo de 4-6 linhas\n            \n            **FORMATO DE SAÍDA:**\n            Retorne apenas o texto da recomendação, sem título ou formatação markdown.\n            '}], 'model': 'gpt-4o', 'max_tokens': 500, 'temperature': 0.7}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 13 Oct 2025 17:18:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-sitqrklbz9btdmisad8q7tj6'), (b'openai-processing-ms', b'3545'), (b'openai-project', b'proj_9512SLV5rqqwN8ADlX3u9SV4'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'3672'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'800000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'799529'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'35ms'), (b'x-request-id', b'req_6d9c4f34959642e0987d3ba6cec93a94'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'98e07e51db45e020-GRU'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 13 Oct 2025 17:18:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-sitqrklbz9btdmisad8q7tj6', 'openai-processing-ms': '3545', 'openai-project': 'proj_9512SLV5rqqwN8ADlX3u9SV4', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '3672', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '799529', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '35ms', 'x-request-id': 'req_6d9c4f34959642e0987d3ba6cec93a94', 'x-openai-proxy-wasm': 'v0.1', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '98e07e51db45e020-GRU', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
DEBUG:openai._base_client:request_id: req_6d9c4f34959642e0987d3ba6cec93a94
INFO:root:Recomendação gerada para domínio Detectar
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-249cebaa-76a3-4512-bb9b-1fcb12f3ba13', 'json_data': {'messages': [{'role': 'system', 'content': 'Você é asst_HMYchoc6I6hHowb8UUqssl4l. Você gera recomendações práticas e diretas para melhorias em assessments de maturidade organizacional.'}, {'role': 'user', 'content': '\n            Como consultor especializado em assessments de maturidade organizacional, analise as respostas do domínio "Reagir" e forneça recomendações práticas de melhoria.\n\n            **DADOS DO DOMÍNIO:**\n            - Nome: Reagir\n            - Descrição: Integrar equipes de backup e segurança em planos de resposta a incidentes, com documentação atualizada e ações rápidas para conter ameaças e validar a integridade dos dados.\n            - Pontuação obtida: 100.0%\n            \n            **RESPOSTAS DO DOMÍNIO:**\n            [\n  {\n    "pergunta": "As áreas de segurança e de resposta a incidentes estão integradas com a área de backup?",\n    "resposta": "Sim",\n    "valor": 5\n  }\n]\n            \n            **INSTRUÇÕES PARA RECOMENDAÇÃO:**\n            1. Analise as respostas considerando:\n               - Respostas "Não" (valor 0) indicam ausência total da prática\n               - Respostas "Parcial" (valor 3) indicam implementação parcial\n               - Respostas "Sim" (valor 5) indicam implementação completa\n            \n            2. Identifique os principais gaps (respostas "Não" e "Parcial")\n            \n            3. Forneça 2-3 recomendações práticas e objetivas focadas em:\n               - Priorizar ações para as áreas com resposta "Não"\n               - Melhorar áreas com resposta "Parcial"\n               - Fortalecer processos já implementados\n            \n            4. Use linguagem direta e profissional\n            \n            5. Estruture a resposta em um único parágrafo de 4-6 linhas\n            \n            **FORMATO DE SAÍDA:**\n            Retorne apenas o texto da recomendação, sem título ou formatação markdown.\n            '}], 'model': 'gpt-4o', 'max_tokens': 500, 'temperature': 0.7}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 13 Oct 2025 17:18:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-sitqrklbz9btdmisad8q7tj6'), (b'openai-processing-ms', b'5216'), (b'openai-project', b'proj_9512SLV5rqqwN8ADlX3u9SV4'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'5237'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'800000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'799528'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'35ms'), (b'x-request-id', b'req_8aa660e7158a4c138e03e027ee11efde'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'98e07e6eae4ee020-GRU'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 13 Oct 2025 17:18:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-sitqrklbz9btdmisad8q7tj6', 'openai-processing-ms': '5216', 'openai-project': 'proj_9512SLV5rqqwN8ADlX3u9SV4', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '5237', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '799528', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '35ms', 'x-request-id': 'req_8aa660e7158a4c138e03e027ee11efde', 'x-openai-proxy-wasm': 'v0.1', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '98e07e6eae4ee020-GRU', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
DEBUG:openai._base_client:request_id: req_8aa660e7158a4c138e03e027ee11efde
INFO:root:Recomendação gerada para domínio Reagir
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-c76880ba-83a5-4c49-bf7a-3fff0a7d8bc9', 'json_data': {'messages': [{'role': 'system', 'content': 'Você é asst_HMYchoc6I6hHowb8UUqssl4l. Você gera recomendações práticas e diretas para melhorias em assessments de maturidade organizacional.'}, {'role': 'user', 'content': '\n            Como consultor especializado em assessments de maturidade organizacional, analise as respostas do domínio "Recuperar" e forneça recomendações práticas de melhoria.\n\n            **DADOS DO DOMÍNIO:**\n            - Nome: Recuperar\n            - Descrição: Assegurar capacidades avançadas de restauração (Instant VM Recovery, granularidade, ambientes isolados) e orquestração de DR para minimizar tempo e impacto em cenários críticos.\n            - Pontuação obtida: 100.0%\n            \n            **RESPOSTAS DO DOMÍNIO:**\n            [\n  {\n    "pergunta": "Restauração Granular de Itens de Active Directory, Aplicações e Banco de Dados é efetuada quando necessário?",\n    "resposta": "Sim",\n    "valor": 5\n  }\n]\n            \n            **INSTRUÇÕES PARA RECOMENDAÇÃO:**\n            1. Analise as respostas considerando:\n               - Respostas "Não" (valor 0) indicam ausência total da prática\n               - Respostas "Parcial" (valor 3) indicam implementação parcial\n               - Respostas "Sim" (valor 5) indicam implementação completa\n            \n            2. Identifique os principais gaps (respostas "Não" e "Parcial")\n            \n            3. Forneça 2-3 recomendações práticas e objetivas focadas em:\n               - Priorizar ações para as áreas com resposta "Não"\n               - Melhorar áreas com resposta "Parcial"\n               - Fortalecer processos já implementados\n            \n            4. Use linguagem direta e profissional\n            \n            5. Estruture a resposta em um único parágrafo de 4-6 linhas\n            \n            **FORMATO DE SAÍDA:**\n            Retorne apenas o texto da recomendação, sem título ou formatação markdown.\n            '}], 'model': 'gpt-4o', 'max_tokens': 500, 'temperature': 0.7}}
DEBUG:openai._base_client:Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 13 Oct 2025 17:18:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-sitqrklbz9btdmisad8q7tj6'), (b'openai-processing-ms', b'4448'), (b'openai-project', b'proj_9512SLV5rqqwN8ADlX3u9SV4'), (b'openai-version', b'2020-10-01'), (b'x-envoy-upstream-service-time', b'4498'), (b'x-ratelimit-limit-requests', b'5000'), (b'x-ratelimit-limit-tokens', b'800000'), (b'x-ratelimit-remaining-requests', b'4999'), (b'x-ratelimit-remaining-tokens', b'799519'), (b'x-ratelimit-reset-requests', b'12ms'), (b'x-ratelimit-reset-tokens', b'36ms'), (b'x-request-id', b'req_ae612f7614354f8a8d800d5e3c950d6d'), (b'x-openai-proxy-wasm', b'v0.1'), (b'cf-cache-status', b'DYNAMIC'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'98e07e919c9ee020-GRU'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:openai._base_client:HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 13 Oct 2025 17:18:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-sitqrklbz9btdmisad8q7tj6', 'openai-processing-ms': '4448', 'openai-project': 'proj_9512SLV5rqqwN8ADlX3u9SV4', 'openai-version': '2020-10-01', 'x-envoy-upstream-service-time': '4498', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '799519', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '36ms', 'x-request-id': 'req_ae612f7614354f8a8d800d5e3c950d6d', 'x-openai-proxy-wasm': 'v0.1', 'cf-cache-status': 'DYNAMIC', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '98e07e919c9ee020-GRU', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
DEBUG:openai._base_client:request_id: req_ae612f7614354f8a8d800d5e3c950d6d
INFO:root:Recomendação gerada para domínio Recuperar
INFO:root:Recomendação atribuída ao domínio Identificar
INFO:root:Recomendação atribuída ao domínio Proteger
INFO:root:Recomendação atribuída ao domínio Detectar
INFO:root:Recomendação atribuída ao domínio Reagir
INFO:root:Recomendação atribuída ao domínio Recuperar
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
