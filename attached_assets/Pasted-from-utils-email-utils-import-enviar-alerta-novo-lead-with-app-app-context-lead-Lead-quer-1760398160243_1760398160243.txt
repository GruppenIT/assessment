from utils.email_utils import enviar_alerta_novo_lead
with app.app_context():
    lead = Lead.query.get(25)
    tipo = TipoAssessment.query.get(3)

    if lead and tipo:
        print('üìß Enviando e-mail de teste com corre√ß√µes de cor...')
        resultado = enviar_alerta_novo_lead(lead, tipo)

        if resultado:
            print('‚úÖ E-mail enviado! Verifique sua caixa de entrada.')
            print('   As cores agora devem estar vis√≠veis corretamente.')
        else:
            print('‚ùå Falha no envio')
"
ENV_LOADER: Carregadas vari√°veis de .env
INFO:root:Blueprint de projetos registrado com sucesso
INFO:root:Blueprint de assessments registrado com sucesso
INFO:root:Blueprint de par√¢metros registrado com sucesso
INFO:root:Blueprint de assessment p√∫blico registrado com sucesso
INFO:root:Portal do cliente registrado com sucesso
INFO:root:Blueprint de leads registrado com sucesso
INFO:root:Configura√ß√µes padr√£o inicializadas
<string>:7: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
<string>:8: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
üìß Enviando e-mail de teste com corre√ß√µes de cor...
DEBUG:root:Logo path encontrado: logos/715b568be35740378f03d145aa7e0bf2.png
DEBUG:root:Par√¢metro 'smtp_password' n√£o encontrado no banco
DEBUG:urllib3.util.retry:Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)
DEBUG:msal.authority:Initializing with Entra authority: https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): login.microsoftonline.com:443
DEBUG:urllib3.connectionpool:https://login.microsoftonline.com:443 "GET /19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/v2.0/.well-known/openid-configuration HTTP/1.1" 200 1753
DEBUG:msal.authority:openid_config("https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/v2.0/.well-known/openid-configuration") = {'token_endpoint': 'https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic'], 'jwks_uri': 'https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/kerberos', 'tenant_region_scope': 'SA', 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}
DEBUG:msal.application:Broker enabled? None
DEBUG:msal.application:Region to be used: None
DEBUG:msal.telemetry:Generate or reuse correlation_id: fbd46618-ae98-4d1d-aa6e-6333123a5f7c
DEBUG:urllib3.connectionpool:https://login.microsoftonline.com:443 "POST /19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/oauth2/v2.0/token HTTP/1.1" 200 5381
DEBUG:msal.token_cache:event={
    "client_id": "9ecd8e51-154a-4e81-ad2b-7e285291d367",
    "data": {
        "refresh_token": "********",
        "scope": [
            "https://outlook.office365.com/.default",
            "offline_access",
            "openid",
            "profile"
        ]
    },
    "environment": "login.microsoftonline.com",
    "grant_type": "refresh_token",
    "params": null,
    "response": {
        "access_token": "********",
        "client_info": "eyJ1aWQiOiJjYzUyYjk1MC00MDAzLTQ5YmItOTU0Yy0wMTljODNmYTA2MTQiLCJ1dGlkIjoiMTljNGVkNDgtZTM4Yy00ZDU1LTg1ZTUtMDk4ZTVmMGU4ZWQ0In0",
        "expires_in": 4625,
        "ext_expires_in": 4625,
        "id_token": "********",
        "refresh_token": "********",
        "scope": "https://outlook.office365.com/SMTP.Send https://outlook.office365.com/User.Read https://outlook.office365.com/.default",
        "token_type": "Bearer"
    },
    "scope": [
        "https://outlook.office365.com/SMTP.Send",
        "https://outlook.office365.com/User.Read",
        "https://outlook.office365.com/.default"
    ],
    "token_endpoint": "https://login.microsoftonline.com/19c4ed48-e38c-4d55-85e5-098e5f0e8ed4/oauth2/v2.0/token"
}
INFO:utils.email_utils:E-mail enviado com sucesso via OAuth2 para rodrigo@gruppen.com.br
INFO:utils.email_utils:Alerta de novo lead enviado para rodrigo@gruppen.com.br
‚úÖ E-mail enviado! Verifique sua caixa de entrada.
   As cores agora devem estar vis√≠veis corretamente.
root@vlxweb12:/var/www/assessment#