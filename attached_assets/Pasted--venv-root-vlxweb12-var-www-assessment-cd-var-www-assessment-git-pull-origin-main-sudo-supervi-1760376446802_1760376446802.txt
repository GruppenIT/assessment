(venv) root@vlxweb12:/var/www/assessment# cd /var/www/assessment
git pull origin main
sudo supervisorctl restart assessment
remote: Enumerating objects: 12, done.
remote: Counting objects: 100% (12/12), done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 7 (delta 5), reused 7 (delta 5), pack-reused 0 (from 0)
Unpacking objects: 100% (7/7), 2.46 KiB | 1.23 MiB/s, done.
From https://github.com/GruppenIT/assessment
 * branch            main       -> FETCH_HEAD
   eb45d36..8a265bb  main       -> origin/main
Updating eb45d36..8a265bb
Fast-forward
 .replit                                                                                                                               |   4 +++
 ...ted--venv-root-vlxweb12-var-www-assessment-cd-var-www-assessment-git-pull-origin-main-sudo-supervi-1760376165458_1760376165458.txt | 101 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 models/lead.py                                                                                                                        |   2 +-
 3 files changed, 106 insertions(+), 1 deletion(-)
 create mode 100644 attached_assets/Pasted--venv-root-vlxweb12-var-www-assessment-cd-var-www-assessment-git-pull-origin-main-sudo-supervi-1760376165458_1760376165458.txt
assessment: stopped
assessment: started
(venv) root@vlxweb12:/var/www/assessment# cd /var/www/assessment
source venv/bin/activate
python3 << 'PYEOF'
from app import app, db
from models.assessment_publico import AssessmentPublico
from models.lead import Lead

with app.app_context():
    for assessment_id in [18, 19, 20, 21]:
        assessment = AssessmentPublico.query.get(assessment_id)
        if assessment and assessment.nome_respondente:
            lead_existente = Lead.query.filter_by(assessment_publico_id=assessment.id).first()

            if not lead_existente:
                print(f"\n=== Criando lead para assessment {assessment_id} ===")
                try:
                    lead = Lead.criar_de_assessment_publico(assessment)
                    print(f"✓ Nome: {lead.nome}")
                    print(f"✓ Email: {lead.email}")
                    print(f"✓ Empresa: {lead.empresa}")

                    db.session.add(lead)
                    db.session.flush()

                    lead.adicionar_historico(
                        acao='criado',
                        detalhes='Lead criado via script de correção'
                    )

                    db.session.commit()
                    print(f"✓ Lead {lead.id} criado com sucesso!")
                except Exception as e:
                    print(f"✗ ERRO: {e}")
                    db.session.rollback()
            else:
                print(f"Assessment {assessment_id}: já tem lead #{lead_existente.id}")

    print("\n=== RESUMO FINAL ===")
    print(f"Total de leads: {Lead.query.count()}")
    for lead in Lead.query.all():
        print(f"  - Lead {lead.id}: {lead.nome} ({lead.empresa})")
PYEOF
ENV_LOADER: Carregadas variáveis de .env
INFO:root:Blueprint de projetos registrado com sucesso
INFO:root:Blueprint de assessments registrado com sucesso
INFO:root:Blueprint de parâmetros registrado com sucesso
INFO:root:Blueprint de assessment público registrado com sucesso
INFO:root:Portal do cliente registrado com sucesso
INFO:root:Blueprint de leads registrado com sucesso
INFO:root:Configurações padrão inicializadas
<stdin>:7: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)

=== Criando lead para assessment 18 ===
✗ ERRO: cannot import name 'AssessmentTipo' from 'models.tipo_assessment' (/var/www/assessment/models/tipo_assessment.py)

=== Criando lead para assessment 19 ===
✗ ERRO: cannot import name 'AssessmentTipo' from 'models.tipo_assessment' (/var/www/assessment/models/tipo_assessment.py)

=== Criando lead para assessment 20 ===
✗ ERRO: cannot import name 'AssessmentTipo' from 'models.tipo_assessment' (/var/www/assessment/models/tipo_assessment.py)

=== Criando lead para assessment 21 ===
✗ ERRO: cannot import name 'AssessmentTipo' from 'models.tipo_assessment' (/var/www/assessment/models/tipo_assessment.py)

=== RESUMO FINAL ===
Total de leads: 1
  - Lead 1: Rodrigo Rocha (Lider Tecnologia)
(venv) root@vlxweb12:/var/www/assessment#