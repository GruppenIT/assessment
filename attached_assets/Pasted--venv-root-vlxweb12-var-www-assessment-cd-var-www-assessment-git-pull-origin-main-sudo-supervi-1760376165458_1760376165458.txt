(venv) root@vlxweb12:/var/www/assessment# cd /var/www/assessment
git pull origin main
sudo supervisorctl restart assessment
remote: Enumerating objects: 22, done.
remote: Counting objects: 100% (22/22), done.
remote: Compressing objects: 100% (7/7), done.
remote: Total 18 (delta 14), reused 15 (delta 11), pack-reused 0 (from 0)
Unpacking objects: 100% (18/18), 8.91 KiB | 1.78 MiB/s, done.
From https://github.com/GruppenIT/assessment
 * branch            main       -> FETCH_HEAD
   fd44842..eb45d36  main       -> origin/main
Updating fd44842..eb45d36
Fast-forward
 ...ted--venv-root-vlxweb12-var-www-assessment-cd-var-www-assessment-source-venv-bin-activate-python3--1760375499217_1760375499217.txt |  44 +++++++++++++++++++++++++
 ...ted--venv-root-vlxweb12-var-www-assessment-cd-var-www-assessment-source-venv-bin-activate-python3--1760375683753_1760375683753.txt |  56 +++++++++++++++++++++++++++++++
 ...Pasted--venv-root-vlxweb12-var-www-assessment-sudo-supervisorctl-tail-f-assessment-stderr-Press-Ct-1760375901553_1760375901553.txt | 125 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 ...ted-root-vlxweb12-cd-var-www-assessment-git-pull-origin-main-sudo-supervisorctl-restart-assessment-1760375020473_1760375020473.txt |  32 ++++++++++++++++++
 models/lead.py                                                                                                                        |  11 ++++++-
 5 files changed, 267 insertions(+), 1 deletion(-)
 create mode 100644 attached_assets/Pasted--venv-root-vlxweb12-var-www-assessment-cd-var-www-assessment-source-venv-bin-activate-python3--1760375499217_1760375499217.txt
 create mode 100644 attached_assets/Pasted--venv-root-vlxweb12-var-www-assessment-cd-var-www-assessment-source-venv-bin-activate-python3--1760375683753_1760375683753.txt
 create mode 100644 attached_assets/Pasted--venv-root-vlxweb12-var-www-assessment-sudo-supervisorctl-tail-f-assessment-stderr-Press-Ct-1760375901553_1760375901553.txt
 create mode 100644 attached_assets/Pasted-root-vlxweb12-cd-var-www-assessment-git-pull-origin-main-sudo-supervisorctl-restart-assessment-1760375020473_1760375020473.txt
assessment: stopped
assessment: started
(venv) root@vlxweb12:/var/www/assessment# cd /var/www/assessment
source venv/bin/activate
python3 << 'PYEOF'
from app import app, db
from models.assessment_publico import AssessmentPublico
from models.lead import Lead
import logging

logging.basicConfig(level=logging.INFO)

with app.app_context():
    # Tentar criar leads para assessments 18, 19 e 20
    for assessment_id in [18, 19, 20]:
        assessment = AssessmentPublico.query.get(assessment_id)
        if assessment and assessment.nome_respondente:
            lead_existente = Lead.query.filter_by(assessment_publico_id=assessment.id).first()

            if not lead_existente:
                print(f"\n=== Criando lead para assessment {assessment_id} ===")
                try:
                    lead = Lead.criar_de_assessment_publico(assessment)
                    print(f"✓ Lead objeto criado: {lead.nome}")

                    db.session.add(lead)
                    db.session.flush()
                    print(f"✓ Lead ID: {lead.id}")

                    lead.adicionar_historico(
                        acao='criado',
                        detalhes=f'Lead criado via script de correção'
                    )

                    db.session.commit()
                    print(f"✓ Lead {lead.id} criado com sucesso!")
                except Exception as e:
                    print(f"✗ ERRO: {e}")
                    import traceback
                    traceback.print_exc()
                    db.session.rollback()
            else:
                print(f"Assessment {assessment_id}: lead já existe (ID {lead_existente.id})")
PYEOF
ENV_LOADER: Carregadas variáveis de .env
INFO:root:Blueprint de projetos registrado com sucesso
INFO:root:Blueprint de assessments registrado com sucesso
INFO:root:Blueprint de parâmetros registrado com sucesso
INFO:root:Blueprint de assessment público registrado com sucesso
INFO:root:Portal do cliente registrado com sucesso
INFO:root:Blueprint de leads registrado com sucesso
INFO:root:Configurações padrão inicializadas
<stdin>:11: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)

=== Criando lead para assessment 18 ===
✗ ERRO: No module named 'models.assessment_tipo'
Traceback (most recent call last):
  File "<stdin>", line 18, in <module>
  File "/var/www/assessment/models/lead.py", line 51, in criar_de_assessment_publico
    from models.assessment_tipo import AssessmentTipo
ModuleNotFoundError: No module named 'models.assessment_tipo'

=== Criando lead para assessment 19 ===
✗ ERRO: No module named 'models.assessment_tipo'
Traceback (most recent call last):
  File "<stdin>", line 18, in <module>
  File "/var/www/assessment/models/lead.py", line 51, in criar_de_assessment_publico
    from models.assessment_tipo import AssessmentTipo
ModuleNotFoundError: No module named 'models.assessment_tipo'

=== Criando lead para assessment 20 ===
✗ ERRO: No module named 'models.assessment_tipo'
Traceback (most recent call last):
  File "<stdin>", line 18, in <module>
  File "/var/www/assessment/models/lead.py", line 51, in criar_de_assessment_publico
    from models.assessment_tipo import AssessmentTipo
ModuleNotFoundError: No module named 'models.assessment_tipo'
(venv) root@vlxweb12:/var/www/assessment#